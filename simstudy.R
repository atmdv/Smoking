pacman::p_load(simstudy)

# Setup definition table for DR2016
def <- defData(varname = "sex", formula = "0.498;0.502", dist = "categorical")
def <- defData(def, varname = "age", formula = "0.07;0.13;0.16;0.19;0.16;0.15;0.14", dist = "categorical")
def <- defData(def, varname = "region", formula = "0.30;0.16;0.21;0.23;0.10", dist = "categorical")
def <- defData(def, varname = "employment", formula = "0.287;0.035;0.199;0.062;0.065;0.044;0.278;0.03", dist = "categorical")
def <- defData(def, varname = "children", formula = "0.65;0.082;0.082;0.066;0.12", dist = "categorical")
def <- defData(def, varname = "education", formula = "0.317;0.089;0.334;0.185;0.075", dist = "categorical")
def <- defData(def, varname = "income", formula = "0.039;0.089;0.115;0.133;0.099;0.072;0.072;0.075;0.073;0.058;0.03;0.047;0.0;0.098", dist = "categorical")
def <- defData(def, varname = "smoking", formula = "0.211;0.789", dist = "categorical")
def <- defData(def, varname = "smoking_details", formula = "0.211;0.310;0.479", dist = "categorical")
def <- defData(def, varname = "ecigs", formula = "0.019;0.005;0.007;0.022;0.111;0.836", dist = "categorical")
def <- defData(def, varname = "smoking_frequency", formula = "0.159;0.018;0.035;0.024;0.023;0.262;0.479", dist = "categorical")
def <- defData(def, varname = "smokefree", formula = "0.01;0.01;0.038;0.024;0.918", dist = "categorical")
def <- defData(def, varname = "risk_ecigs", formula = "0.596;0.062;0.342", dist = "categorical")
def <- defData(def, varname = "ecigs_indoors", formula = "0.026;0.011;0.009;0.061;0.893", dist = "categorical")
def <- defData(def, varname = "ecigs_car", formula = "0.01;0.774;0.216", dist = "categorical")
def <- defData(def, varname = "gum", formula = "0.009;0.007;0.081;0.903", dist = "categorical")
def <- defData(def, varname = "other", formula = "0.007;0.008;0.065;0.92", dist = "categorical")
def <- defData(def, varname = "indoors", formula = "0.107;0.015;0.012;0.083;0.783", dist = "categorical")
def <- defData(def, varname = "car", formula = "0.012;0.765;0.223", dist = "categorical")

# Generate simulated data for DR2016
data <- genData(5062*100, def)

# Add labels to variables
data$sex <- factor(data$sex, labels=c("Mand", "Kvinde"))
data$age <- factor(data$age, labels=c("15-19", "20-29", "30-39", "40-49", "50-59", "60-69", "70+"))
data$region <- factor(data$region, labels=c("Hovedstaden", "Sjælland", "Syddanmark", "Midtjylland", "Nordjylland"))
data$employment <- factor(data$employment, labels=c("Ja, ansat privat", "Ja, selvstændig", "Ja, ansat offentligt", "Ja, studiejob", "Nej, uddannelse", "Nej, arbejdsløs", "Nej, pension", "Nej, andet"))
data$children <- factor(data$children, labels=c("ingen", "0-4", "5-10", "11-15", "15+"))
data$education <- factor(data$education, labels=c("grundskole", "Gymnasium", "Erhvervs", "KVU/MVU", "LVU"))
data$income <- factor(data$income, labels=c("<199", "120-199", "200-299", "300-399", "400-499", "500-599", "600-699", "700-799", "800-899", "900-999", "1+ mio.", "ved ikke", "ønsker ikke"))
data$smoking <- factor(data$smoking, labels=c("Ryger", "Ikke-ryger"))
data$smoking_details <- factor(data$smoking_details, labels=c("Ryger", "Eks-ryger", "Ikke-ryger"))
data$ecigs <- factor(data$ecigs, labels=c("Ja, dagligt", "Ja, ugentligt", "Ja, sjældnere", "Nej, tidligere", "Nej, prøvet", "Nej, aldrig"))
data$smoking_frequency <- factor(data$smoking_frequency, labels=c("Ja, daligt", "Ja, ugentligt", "Ja, sjældnere", "Nej, stoppet i år", "Nej, stoppet 1-3 år", "Nej, stoppet 3+ år", "Nej, aldrig"))
data$smokefree <- factor(data$smokefree, labels=c("Ja, daligt", "Ja, ikke dagligt", "Nej, prøvet", "Nej, tidligere", "Nej, aldrig"))
data$risk_ecigs <- factor(data$risk_ecigs, labels=c("Ja", "Nej", "Ved ikke"))
data$ecigs_indoors <- factor(data$ecigs_indoors, labels=c("Ja, dagligt", "Ja, ugentligt", "Ja, månedligt", "Ja, sjældnere", "Nej"))
data$ecigs_car <- factor(data$ecigs_car, labels=c("Ja", "Nej", "Ingen bil"))
data$gum <- factor(data$gum, labels=c("Ja, dagligt", "Ja, ikke dagligt", "Nej, tidligere", "Nej, aldrig"))
data$other <- factor(data$other, labels=c("Ja, dagligt", "Ja, ikke dagligt", "Nej, tidligere", "Nej, aldrig"))
data$indoors <- factor(data$indoors, labels=c("Ja, dagligt", "Ja, ugentligt", "Ja, månedligt", "Ja, sjældnere", "Nej"))
data$car <- factor(data$car, labels=c("Ja", "Nej", "Ingen bil"))

# Test simulated data
table(data$age)
table(data$sex,data$age)
prop.table(table(data$age))
